<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NSW Driver Licence</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            margin: 0;
            background-color: #fff;
            max-width: 430px;
            margin: 0 auto;
            min-height: 100vh;
        }
        .card {
            width: 100%;
            background: #fff;
            border-radius: 12px;
            overflow: hidden;
            font-family: 'Roboto', sans-serif;
            box-shadow: none;
            position: relative;
            display: flex;
            flex-direction: column;
            isolation: isolate;
            color: #022551;
            margin: 27px auto;
        }

        .card > .top-title-header,
        .card > .flipped-svg-header,
        .card > .identity-section,
        .card > .photo-block,
        .card > .info-center,
        .card > .license-details,
        .card > .class-conditions,
        .card > .address-block,
        .card > .signature-block,
        .card > .footer {
            position: relative;
            z-index: 2;
        }

        .background-logo {
            position: absolute; 
            top: 45%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 120%; /* Adjustable size */
            height: auto;
            opacity: 0.5; /* Faint background effect */
            z-index: 2; /* Brought forward one layer */
            pointer-events: none;
        }

        .hologram-block {
            position: absolute;
            top: 0;
            left: 0;
            padding-bottom: 20px;
            width: 130%;
            height: 100%;
            align-items: center;
            justify-content: center;
            z-index: 2;
            opacity: 0.3;
            pointer-events: none;
            overflow: hidden;
        }

        .hologram-block svg {
            width: 180%;
            height: auto;
            max-width: auto;
        }

        .top-title-header {
            background-color: #fff;
            color: #022551;
            text-align: center;
            padding: 16px 16px;
            font-size: 14px;
            font-weight: 500;
            border-bottom: 1px solid #eee;
        }

        .flipped-svg-header {
            height: 30px;
            overflow: hidden;
            position: relative;
            background: #fff;
        }

        .flipped-svg-header > svg {
            position: absolute;
            top: 5%;
            left: 0;
            width: 100%;
            height: 100%;
            transform: scaleY(-1);
            object-fit: cover;
            pointer-events: none;
        }

        .identity-section {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 10px 16px 0;
            background: transparent;
            font-size: 14px;
        }

        .identity-section .nsw-logo {
            width: 60px;
            height: auto;
            flex-shrink: 0;
        }

        .identity-section .refreshed-date small {
            font-size: 15px;
            text-align: right;
            color: #9f9fa3;
            display: block;
            flex-shrink: 0;
        }

        .photo-block {
            display: flex;
            justify-content: center;
            padding: 0;
            position: relative;
            flex-grow: 1;
            align-items: center;
        }

        .license-photo {
            width: 190px;
            height: 220px;
            object-fit: cover;
        }

        .info-center {
            text-align: center;
            padding: 5px 0 20px;
            color: #022551;
            font-weight: 450;
        }

        .info-center .name-first-middle {
            font-size: 22px;
            font-weight: 450;
            line-height: 1.1;
        }

        .info-center .name-last {
            font-size: 22px;
            font-weight: normal;
            text-transform: uppercase;
            margin-top: 2px;
            font-weight: 450;
            line-height: 1.1;
        }

        .license-details {
            display: flex;
            justify-content: space-between;
            padding: 10px 16px 20px;
            position: relative;
            color: #022551;
            background: transparent;
        }

        .license-details .left .label,
        .class-conditions .label,
        .address-block .label,
        .signature-block .label 
        .card-number .value {
            font-size: 14px;
            text-transform: uppercase;
            color: #022551;
            padding-top: 8px;
            margin-bottom: 10px;
            font-weight: 450;
            position: relative;
            z-index: 2;
        }

        .license-details .left .value,
        .class-conditions .value,
        .address-block .value {
            font-size: 22px;
            font-weight: 450;
            margin-bottom: 8px;
            color: #022551;
            position: relative;
            z-index: 2;
        }

        .qr img {
            width: 190px;
            height: 190px;
        }

        .class-conditions {
            display: flex;
            justify-content: space-around;
            padding: 10px 16px 20px;
            background: #fff;
        }

        .class-conditions div {
            width: 50%;
            text-align: center;
            background: #f2f2f2;
            border-radius: 6px;
            padding: 20px;
            font-size: 14px;
        }

        .address-block {
            padding: 0 16px 20px;
            height: 200px;
            background: transparent;
            position: relative;
            background: #fff;
        }

        .address-photo-background {
            background: #fff;
            position: absolute;
            top: 0;
            left: 10;
            width: auto;
            height: auto;
            display: flex;
            align-items: left;
            justify-content: left;
            z-index: 1;
            opacity: 0.4;
            pointer-events: none;
            overflow: hidden;
        }

        .address-background-photo-img {
            width: 130px;
            height: 200px;
            object-fit: cover;
            background: #fff;
        }

        .signature-block {

            padding: 0 16px 30px;
            background: #fff;
            margin-bottom: auto;
        }

        .signature-block .signature-image {
            margin-top: 20px;
            width: auto;
            max-height: 100px;
            display: block;
            align-self: center;
        }

        .card-number {
            font-size: 18px;
            font-weight: 450;
            margin-bottom: 0;
            color: #022551;
            text-align: left;
            flex-grow: 1;
            position: relative;
            z-index: 3;
        }


        .footer {
            position: relative;
            background: #fff;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            padding: 50px 16px;
            font-size: 20px;
            font-weight: 600;
            color: #022551;
            margin-bottom: 0;
            line-height: 1.6;
            z-index: 2;
        }

        .footer > svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            object-fit: cover;
            pointer-events: none;
        }

        .footer .nsw-logo {
            width: 60px;
            height: auto;
            flex-shrink: 0;
            position: relative;
            z-index: 3;
        }
    </style>
</head>
<body>
    <div class="card">  

        <div class="hologram-block"></div>

        <div class="top-title-header">NSW Driver Licence</div>
        
        <div class="flipped-svg-header">
            <svg viewBox="0 0 1440 900" preserveAspectRatio="xMidYMid slice">
              <polygon fill="#fff9c4" points="0,450 1440,600 1440,900 0,900"/>
              <polygon fill="#ffeb3b" points="0,600 1440,450 1440,900 0,900"/>
            </svg>
        </div>
        
        <div class="identity-section">
            <img src="../../assets/logo.png" alt="NSW Logo" class="nsw-logo">
            <div class="photo-block">
                <img src="" alt="Photo" class="license-photo" id="cardPhoto">
            </div>
            <div class="refreshed-date">
                <small id="cardRefreshed">Refreshed<br>05 Jul 2025<br>03:53pm</small>
            </div>
        </div>
        
        <div class="info-center">
            <div class="name-first-middle" id="cardFirstMiddle">First Middle Name</div>
            <div class="name-last" id="cardLast">LASTNAME</div>
        </div>
        
        <div class="license-details">
            <div class="left">
                <div class="label">LICENCE NUMBER</div>
                <div class="value" id="cardLicenceNumber">N/A</div>
                <div class="label">EXPIRY</div>
                <div class="value" id="cardExpiry">N/A</div>
                <div class="label">DATE OF BIRTH</div>
                <div class="value" id="cardDOB">N/A</div>
            </div>
            <div class="qr">
                <img src="" alt="QR Code" id="cardQR">
            </div>
        </div>
        
        <div class="class-conditions">
            <div>
                <span class="label">CLASS</span>
                <span class="value" id="cardClass">C</span>
            </div>
            <div>
                <span class="label">CONDITIONS</span>
                <span class="value" id="cardConditions">â€”</span>
            </div>
        </div>
        
        <div class="address-block">
            <div class="address-photo-background">
                <img src="" alt="Background Photo" class="address-background-photo-img" id="cardAddressPhoto">
            </div>
            <div class="label">ADDRESS</div>
            <div class="value" id="cardAddress">47 WARATAH AVE,<br>RANDWICK NSW 2031</div>
        </div>
        
        <div class="signature-block">
            <div class="label">SIGNATURE</div>
            <img src="../../assets/signature.png" alt="Signature" class="signature-image" id="cardSignature">
        </div>
        
        <div class="footer">
            <svg viewBox="0 0 1440 900" preserveAspectRatio="none">
                <polygon fill="#fff9c4" points="0,150 1440,300 1440,900 0,900"/>
                <polygon fill="#ffeb3b" points="0,300 1440,150 1440,900 0,900"/>
            </svg>
            <div class="card-number">
                <small>CARD NUMBER</small><br>
                <span id="cardNumber">card_number</span>
            </div>
            <div>
                <img src="../../assets/logo.png" alt="NSW Logo" class="nsw-logo">
            </div>
        </div>
        <button onclick="saveCardHTML()" style="
            display: block;
            margin: 10px auto;
            padding: 10px 20px;
            background-color: #022551;
            color: white;
            font-weight: bold;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
        ">
            Save Card as HTML
        </button>

        
        <script>
            function generateSwirlPath() {
                const x = Math.random() * 259;
                const y = Math.random() * 247;
                const radius = Math.random() * 30 + 10;
                const angle1 = Math.random() * 360;
                const angle2 = angle1 + (Math.random() * 180 + 90);
                const controlX1 = x + Math.cos(angle1 * Math.PI / 180) * radius;
                const controlY1 = y - Math.sin(angle1 * Math.PI / 180) * radius;
                const controlX2 = x + Math.cos(angle2 * Math.PI / 180) * radius;
                const controlY2 = y - Math.sin(angle2 * Math.PI / 180) * radius;
                return `M${x},${y} C${controlX1},${controlY1} ${controlX2},${controlY2} ${x},${y}`;
            }

            function createSwirlPatterns(count = 5) {
                const swirlGroup = document.getElementById('swirlPatterns');
                swirlGroup.innerHTML = '';
                for (let i = 0; i < count; i++) {
                    const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
                    path.setAttribute('d', generateSwirlPath());
                    path.setAttribute('fill', 'none');
                    path.setAttribute('stroke', 'url(#hologramGradientBase)');
                    path.setAttribute('stroke-width', Math.random() * 1.5 + 0.5);
                    path.setAttribute('opacity', Math.random() * 0.4 + 0.3);
                    path.setAttribute('transform', `rotate(${Math.random() * 360} ${Math.random() * 259} ${Math.random() * 247})`);
                    swirlGroup.appendChild(path);
                }
            }

            function updateLiveTime() {
                const now = new Date();
                const aestOffset = 10 * 60; // AEST is UTC+10 in hours
                const aestTime = new Date(now.getTime() + aestOffset * 60 * 1000);
                const options = { day: '2-digit', month: 'short', year: 'numeric', hour: '2-digit', minute: '2-digit', hour12: true };
                const formattedDate = aestTime.toLocaleString('en-AU', options).replace(',', '').split(' ');
                const time = formattedDate.pop().toLowerCase();
                const datePart = formattedDate.join(' ').replace(/(\d+)/, '$1 ');
                document.getElementById('cardRefreshed').innerHTML = `Refreshed<br>${datePart}<br>${time}`;
            }

            window.addEventListener('load', () => {
                createSwirlPatterns(5);
                setInterval(() => createSwirlPatterns(5), 5000);
                updateLiveTime();
                setInterval(updateLiveTime, 1000);
            });

            window.addEventListener('DOMContentLoaded', () => {
                const data = JSON.parse(localStorage.getItem('nswLicenceData') || '{}');
                if (data.licenseName) {
                    const parts = data.licenseName.trim().split(' ');
                    document.getElementById('cardFirstMiddle').textContent = parts.slice(0, -1).join(' ') || parts[0] || '';
                    document.getElementById('cardLast').textContent = (parts.length > 1 ? parts[parts.length - 1] : '').toUpperCase();
                }
                if (data.licenseNumber) {
                    document.getElementById('cardLicenceNumber').textContent = data.licenseNumber;
                    document.getElementById('cardNumber').textContent = data.licenseNumber;
                } else {
                    document.getElementById('cardNumber').textContent = 'card_number';
                }
                if (data.expiryDate) document.getElementById('cardExpiry').textContent = data.expiryDate;
                if (data.dateOfBirth) document.getElementById('cardDOB').textContent = data.dateOfBirth;
                if (data.address) document.getElementById('cardAddress').innerHTML = data.address.replace(/\n/g, '<br>');
                else document.getElementById('cardAddress').innerHTML = '47 WARATAH AVE,<br>RANDWICK NSW 2031';
                if (data.classType) document.getElementById('cardClass').textContent = data.classType;
                if (data.conditions) document.getElementById('cardConditions').textContent = data.conditions;
                if (data.photoDataUrl) document.getElementById('cardPhoto').src = data.photoDataUrl;
                if (data.signatureDataUrl) document.getElementById('cardSignature').src = data.signatureDataUrl;
                else document.getElementById('cardSignature').src = '../../assets/signature.png';
                if (data.addressPhotoDataUrl) document.getElementById('cardAddressPhoto').src = data.addressPhotoDataUrl;
                if (data.refreshed) document.getElementById('cardRefreshed').innerHTML = data.refreshed.replace(/\n/g, '<br>');
                const qrData = {
                    licenseNumber: data.licenseNumber || '',
                    licenseName: data.licenseName || '',
                    dateOfBirth: data.dateOfBirth || '',
                    expiryDate: data.expiryDate || '',
                    address: data.address || '47 WARATAH AVE, RANDWICK NSW 2031',
                    cardNumber: data.cardNumber || 'card_number'
                };
                const qrString = encodeURIComponent(JSON.stringify(qrData));
                const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=190x190&data=${qrString}`;
                document.getElementById('cardQR').src = qrUrl;
            });
            function saveCardHTML() {
                const card = document.querySelector('.card');
                const doctype = "<!DOCTYPE html>";
                const htmlStart = `<html lang="en"><head><meta charset='UTF-8'><title>NSW Licence</title><link href='https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap' rel='stylesheet'><style>${document.querySelector('style').innerHTML}</style></head><body>`;
                const htmlEnd = '</body></html>';
                const cardHTML = card.outerHTML;
                const blob = new Blob([doctype + htmlStart + cardHTML + htmlEnd], { type: 'text/html' });

                const link = document.createElement('a');
                link.href = URL.createObjectURL(blob);
                link.download = 'nsw.html';
                link.click();
                URL.revokeObjectURL(link.href);
            }
        </script>
    </div>
</body>
</html>